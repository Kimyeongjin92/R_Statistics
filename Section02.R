##­ ===================================================================================
##­ [ë¹…ë°ì´í„°ë¥¼ í™œìš©í•œ ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ì „ë¬¸ê°€ ì–‘ì„±ê³¼ì •]  ================================
##­ [ì œëŒ€ë¡œ ì•Œê³  ì“°ëŠ” í†µê³„ë¶„ì„ R]                      ================================
##­ 2019-06-19-(ìˆ˜) / 63page                           ================================
##­ ===================================================================================

### ===================================================================================
### ­ 2. ëª¨ìˆ˜ì™€ í†µê³„ëŸ‰   ==============================================================
### ===================================================================================

setwd('D:/dudwlsrla92/R_Statistics/ch02')
getwd()

ranicafe <- read.csv('cafedata.csv',stringsAsFactors = F)
str(ranicafe)
dim(ranicafe)

### ===================================================================================
##­ 1) ìµœëŒ“ê°’ê³¼ ìµœì†Ÿê°’: ranicafe ì»¤í”¼íŒë§¤ëŸ‰
### ===================================================================================

ranicafe$Coffees<-as.numeric(ranicafe$Coffees)
sort(ranicafe$Coffees)
sort(ranicafe$Coffees)[1]
sort(ranicafe$Coffees,decreasing=T)
sort(ranicafe$Coffees,decreasing=T)[1]
min(ranicafe$Coffees,na.rm=T)
max(ranicafe$Coffees,na.rm=T)


### ===================================================================================
##­ 2) ìµœë¹ˆê°’: ranicafe
### ===================================================================================

stem(ranicafe$Coffees)
hist(ranicafe$Coffees)
# ì¤„ê¸°-ì ê·¸ë¦¼ì„ í†µí•´ ìµœë¹ˆê°’ì€ 4ë¼ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆë‹¤.


### ===================================================================================
##­ 3) í‰ê· ê³¼ ì¤‘ì•™ê°’: ranicafe
### ===================================================================================

### ëŒ€í‘¯ê°’ : ì „ì²´ìë£Œë¥¼ ëŒ€í‘œí•˜ëŠ” ê°’ìœ¼ë¡œ ì¤‘ì‹¬ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” íŠ¹ì„±ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
### ìë£Œì˜ ì¤‘ì‹¬ì€ ë¬´ê²Œì¤‘ì‹¬:(ì‚°ìˆ )í‰ê· , ìˆœì„œìƒ ì¤‘ê°„:ì¤‘ì•™ê°’
### í‰ê· ì€ ì´ìƒì¹˜ì— ì•½í•˜ë‹¤.
### í‰ê· ê³¼ ì¤‘ì•™ê°’ì´ ë¹„ìŠ·í•œ ê²½ìš° í‰ê· (í˜¹ì€ ì¤‘ì•™ê°’)ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì¢Œìš°ëŒ€ì¹­ì¸ ê²½ìš°ê°€ ë§ë‹¤.

# â‘ -1) í‰ê· (ë ê°’ì˜ ë³€í™”ì— ë¯¼ê°í•¨.)
rc <- ranicafe$Coffees
weight <-1/(length(rc)-1)   # NA ê°œìˆ˜ë¥¼ ë¹¼ì£¼ì–´ì•¼ í•´ì„œ -1 í•´ì¤Œ.
sum(rc*weight,na.rm=T)      # í‰ê· 
mean(rc, na.rm=T)

# â‘ -2) ì´ìƒì¹˜ê°€ ìˆëŠ” í‰ê· 
rc[rc == max(rc,na.rm=T)] <- 480 # ì´ìƒì¹˜ë¥¼ ë„£ì€ ìƒíƒœ.
mean(rc, na.rm=T)

# â‘¡-1) ì¤‘ì•™ê°’(ì–‘ ëê°’ì˜ ë³€í™”ì— ë‘”ê°í•˜ë‹¤.)
median.idx <- (1+length(rc)-1)/2 # ex) 1,2,3,4,5ì—ì„œ 3ì€ (1+5)/2ë¡œ êµ¬í•  ìˆ˜ ìˆë‹¤.
sort(rc)[median.idx]

median(rc,na.rm=T)


### ===================================================================================
##­ 4) ë¶„ì‚°ê³¼ í‘œì¤€í¸ì°¨
### ===================================================================================

### ëŒ€í‘¯ê°’ì—ì„œ ì·¨ì•½í•œ ë°ì´í„°ì˜ í¼ì§„ ì •ë„ë¥¼ ì•Œ ìˆ˜ ìˆë‹¤.


height <- c(164,166,168,170,172,174,176)
(height.m   <- mean(height))
(height.dev <- height - height.m)  # ê±°ë¦¬ë¥¼ ì•Œê¸° ìœ„í•´ í‰ê· ê°’ìœ¼ë¡œ í•˜ë‚˜ì”© ë¹¼ì¤€ë‹¤.
sum(height.dev)                    # ëª¨ë“  í•©ì´ ê°™ì€ ê°’ì˜ +ì™€ -ë¡œ ì¸í•´ 0

height.dev2 <- height.dev^2  
sum(height.dev2)
variance <- sum(height.dev2)/length(height) # ë¶„ì‚°ê°’
standard_deviation <- sqrt(variance)        # í‘œì¤€í¸ì°¨ (ë¶„ì‚°ì„ ë£¨íŠ¸ì”Œìš´ê²ƒ)

mean(height)                  
var(height)
sd(height)   # Rì—ì„œëŠ” ëª¨ì§‘ë‹¨(N)ì´ ì•„ë‹Œ í‘œë³¸ì§‘ë‹¨(n)ìœ¼ë¡œ ë‚˜ëˆˆë‹¤. ì¦‰, í‘œë³¸ì˜ ë¶„ì‚°ê³¼ í‘œì¤€í¸ì°¨ì´ë‹¤.

#­ ì‹œê·¸ë§ˆ(xi-u)^2     ì‹œê·¸ë§ˆ(Xi-xë°”)^2        u(ë®¤) : ëª¨ì§‘ë‹¨ í‰ê·  xë°”: í‘œë³¸ì§‘ë‹¨ í‰ê· 
#­ --------------     ----------------        N     : ëª¨ì§‘ë‹¨ ê°¯ìˆ˜ n  : í‘œë³¸ì§‘ë‹¨ ê°¯ìˆ˜     
#­       N                   n-1


### ===================================================================================
##­ 5) ì‚¬ë¶„ìœ„ìˆ˜(quantile : í€€ íƒ€ì¼) 25% 50% 75% 100%
### ===================================================================================

quantile(rc, na.rm=T)
qs <- quantile(rc, na.rm=T)
qs[4] - qs[2]    # 3ë¶„ìœ„ìˆ˜ - 1ë¶„ìœ„ìˆ˜
IQR(rc,na.rm=T)  # IQR(InterQuantile Range)

rc[rc==max(rc,na.rm= T)] <- 48 # ì´ìƒì¹˜ë¥¼ ì›ë˜ ê°’ìœ¼ë¡œ
bp <- boxplot(rc,main="ì»¤í”¼ íŒë§¤ëŸ‰ì— ëŒ€í•œ ìƒìë„í‘œ",axes=F)

# ì´ìƒì¹˜(Outlier)
boxplot(cars$dist)
qs <- quantile(cars$dist)
qs 
iqr <- qs[4]-qs[2]            ;iqr        # +30  ì¤‘ê°„ê°’
UpperLimit <- qs[4] + 1.5*iqr ;UpperLimit # +101 ë³´ë‹¤ í° ê²ƒ
LowerLimit <- qs[2] - 1.5*iqr ;LowerLimit # -19  ë³´ë‹¤ ì‘ì€ ê²ƒì´ ì´ìƒì¹˜ê°€ ëœë‹¤.

cars$dist[cars$dist>UpperLimit]           # ìœ„ì˜ ì´ìƒì¹˜
cars$dist[cars$dist<LowerLimit]           # ë°‘ì˜ ì´ìƒì¹˜

# ëª¨ìˆ˜ëŠ” ëª¨ì§‘ë‹¨
# í†µê³„ëŸ‰ì€ í‘œë³¸ì§‘ë‹¨ì„ ëœ»í•œë‹¤.